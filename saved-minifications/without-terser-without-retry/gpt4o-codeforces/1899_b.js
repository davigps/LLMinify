function getDivisors(n){var d=[];for(var i=1;i<=Math.sqrt(n);++i)if(n%i===0){d.push(i);i!==n/i&&d.push(n/i)}return d}function process(){var n=parseInt(readline().trim()),v=readline().trim().split(' ').map(function(v){return parseInt(v)}),p=[v[0]];for(var i=1;i<n;++i)p[i]=p[i-1]+v[i];var d=getDivisors(n),a=0;for(var i=0;i<d.length;++i){var D=d[i],mn=Number.MAX_VALUE,mx=-Number.MAX_VALUE;for(var j=D-1;j<n;j+=D){var t=p[j]-((j-D>=0)?p[j-D]:0);mn=Math.min(mn,t);mx=Math.max(mx,t)}a=Math.max(a,mx-mn)}print(a)}var t=parseInt(readline().trim());while(t--)process();
